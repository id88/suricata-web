import{d as J,a as K,r as b,X as O,c as h,b as C,e as o,f as e,w as s,E as X,h as Y,p as Z,N as q,Y as H,Z as M,C as Q,l as y,$ as W,k as _,a0 as ee,a1 as te,a2 as ae,B as x,J as le,K as se,t as f,D as oe,I as ne,L as re,n as ie,o as m,_ as ue}from"./index-t3hrDPiS.js";/* empty css                *//* empty css               */const de={class:"global-list-page"},ce={class:"search-section"},pe={class:"search-filters"},_e={class:"filter-item"},fe={class:"filter-item"},me={class:"filter-item"},ge={class:"filter-actions"},be={class:"table-container"},ve={class:"alert-types"},we={key:1,class:"text-gray"},he={class:"pagination-container"},Ce=J({__name:"GlobalList",setup(ye){const z=ie(),T=K(),c=b(!1),i=b(1),d=b(20),n=O({filename:"",alertFilter:"",statusFilter:""}),v=h(()=>T.searchTrafficPackets(n.filename,n.alertFilter,n.statusFilter)),k=h(()=>{const l=(i.value-1)*d.value,t=l+d.value;return v.value.slice(l,t)}),E=()=>{c.value=!0,i.value=1,setTimeout(()=>{c.value=!1},300)},S=()=>{n.filename="",n.alertFilter="",n.statusFilter="",i.value=1},V=l=>{d.value=l,i.value=1},F=l=>{i.value=l},B=l=>{z.push(`/alert/${l}`)},D=l=>l===0?"text-gray":l>30?"text-danger":l>10?"text-warning":"text-success",I=l=>{switch(l){case"completed":return"success";case"analyzing":return"warning";case"failed":return"danger";default:return"info"}},L=l=>{switch(l){case"completed":return"已完成";case"analyzing":return"分析中";case"failed":return"失败";default:return"未知"}},P=l=>{switch(l){case"analyzing":return"分析中";case"failed":return"分析失败";default:return"等待完成"}};return(l,t)=>{const U=q,p=Z,u=M,w=H,g=Q,N=X,r=le,R=oe,$=ne,A=re,G=Y,j=ae;return m(),C("div",de,[o("div",ce,[o("div",pe,[e(N,{gutter:20},{default:s(()=>[e(p,{xs:24,sm:6},{default:s(()=>[o("div",_e,[t[5]||(t[5]=o("label",{class:"filter-label"},"文件名",-1)),e(U,{modelValue:n.filename,"onUpdate:modelValue":t[0]||(t[0]=a=>n.filename=a),placeholder:"搜索文件名",clearable:"",class:"filter-input"},null,8,["modelValue"])])]),_:1}),e(p,{xs:24,sm:6},{default:s(()=>[o("div",fe,[t[6]||(t[6]=o("label",{class:"filter-label"},"告警数量",-1)),e(w,{modelValue:n.alertFilter,"onUpdate:modelValue":t[1]||(t[1]=a=>n.alertFilter=a),placeholder:"全部",clearable:"",class:"filter-select"},{default:s(()=>[e(u,{label:"全部",value:""}),e(u,{label:"有告警",value:"with_alerts"}),e(u,{label:"无告警",value:"no_alerts"})]),_:1},8,["modelValue"])])]),_:1}),e(p,{xs:24,sm:6},{default:s(()=>[o("div",me,[t[7]||(t[7]=o("label",{class:"filter-label"},"状态",-1)),e(w,{modelValue:n.statusFilter,"onUpdate:modelValue":t[2]||(t[2]=a=>n.statusFilter=a),placeholder:"全部",clearable:"",class:"filter-select"},{default:s(()=>[e(u,{label:"全部",value:""}),e(u,{label:"已完成",value:"completed"}),e(u,{label:"分析中",value:"analyzing"}),e(u,{label:"分析失败",value:"failed"})]),_:1},8,["modelValue"])])]),_:1}),e(p,{xs:24,sm:6},{default:s(()=>[o("div",ge,[e(g,{type:"primary",icon:y(W),onClick:E,loading:c.value},{default:s(()=>t[8]||(t[8]=[_(" 搜索 ")])),_:1},8,["icon","loading"]),e(g,{icon:y(ee),onClick:S},{default:s(()=>t[9]||(t[9]=[_(" 重置 ")])),_:1},8,["icon"])])]),_:1})]),_:1})])]),e(G,{class:"list-card"},{default:s(()=>[o("div",be,[te((m(),x($,{data:k.value,"default-sort":{prop:"uploadTime",order:"descending"},stripe:"",class:"data-table"},{default:s(()=>[e(r,{prop:"filename",label:"文件名","min-width":"280","show-overflow-tooltip":"",sortable:""}),e(r,{prop:"fileSize",label:"文件大小",width:"120",sortable:""}),e(r,{prop:"uploadTime",label:"上传时间",width:"160",sortable:""}),e(r,{prop:"analysisTime",label:"分析耗时",width:"120",sortable:""}),e(r,{prop:"alertCount",label:"告警数量",width:"120",sortable:""},{default:s(a=>[o("span",{class:se(D(a.row.alertCount))},f(a.row.alertCount),3)]),_:1}),e(r,{prop:"alertTypes",label:"告警种类",width:"120",sortable:""},{default:s(a=>[o("span",ve,f(a.row.alertTypes||0),1)]),_:1}),e(r,{prop:"userIp",label:"用户IP",width:"130",sortable:""}),e(r,{prop:"userLocation",label:"用户地区",width:"110"}),e(r,{label:"状态",width:"100"},{default:s(a=>[e(R,{type:I(a.row.status),size:"small"},{default:s(()=>[_(f(L(a.row.status)),1)]),_:2},1032,["type"])]),_:1}),e(r,{label:"操作",width:"120",fixed:"right"},{default:s(a=>[a.row.status==="completed"?(m(),x(g,{key:0,type:"primary",link:"",size:"small",onClick:xe=>B(a.row.id)},{default:s(()=>t[10]||(t[10]=[_(" 查看详情 ")])),_:2},1032,["onClick"])):(m(),C("span",we,f(P(a.row.status)),1))]),_:1})]),_:1},8,["data"])),[[j,c.value]])]),o("div",he,[e(A,{"current-page":i.value,"onUpdate:currentPage":t[3]||(t[3]=a=>i.value=a),"page-size":d.value,"onUpdate:pageSize":t[4]||(t[4]=a=>d.value=a),"page-sizes":[10,20,50,100],total:v.value.length,background:!0,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:V,onCurrentChange:F},null,8,["current-page","page-size","total"])])]),_:1})])}}}),Ee=ue(Ce,[["__scopeId","data-v-5d13272a"]]);export{Ee as default};
