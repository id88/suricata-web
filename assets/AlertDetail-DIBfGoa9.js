import{d as I,a as T,c as k,T as C,b as E,e as l,f as e,w as a,l as i,U as B,C as D,t as _,V as S,h as N,k as n,I as R,J as V,D as A,W as P,n as J,o as U,_ as W}from"./index-t3hrDPiS.js";/* empty css                */const j={class:"alert-detail-page"},q={class:"page-header"},z={class:"header-left"},F={class:"page-subtitle"},G={class:"header-right"},H={class:"section-header"},K=I({__name:"AlertDetail",setup(L){const f=J(),m=C(),h=T(),d=k(()=>{const o=Number(m.params.id);return h.getAnalysisResult(o)}),w=()=>{f.back()},b=o=>{switch(o){case"high":return"danger";case"medium":return"warning";case"low":return"info";default:return"info"}},g=o=>{switch(o){case"high":return"高危";case"medium":return"中危";case"low":return"低危";default:return"未知"}};return(o,t)=>{var c;const r=D,v=A,s=V,y=R,x=N;return U(),E("div",j,[l("div",q,[l("div",z,[e(r,{onClick:w,icon:i(B),plain:""},{default:a(()=>t[0]||(t[0]=[n(" 返回 ")])),_:1},8,["icon"]),l("p",F,_((c=d.value)==null?void 0:c.filename)+" 的检测结果",1)]),l("div",G,[e(r,{icon:i(S),class:"download-btn"},{default:a(()=>t[1]||(t[1]=[n(" 下载文件 ")])),_:1},8,["icon"])])]),e(x,{class:"alerts-section"},{header:a(()=>[l("div",H,[t[3]||(t[3]=l("h2",{class:"section-title"},"告警列表",-1)),e(r,{icon:i(P),class:"export-btn"},{default:a(()=>t[2]||(t[2]=[n(" 导出告警列表 ")])),_:1},8,["icon"])])]),default:a(()=>{var u;return[e(y,{data:(u=d.value)==null?void 0:u.alerts,style:{width:"100%","max-width":"100%"},"default-sort":{prop:"timestamp",order:"descending"}},{default:a(()=>[e(s,{label:"严重等级",width:"140"},{default:a(p=>[e(v,{type:b(p.row.severity),effect:"plain"},{default:a(()=>[n(_(g(p.row.severity)),1)]),_:2},1032,["type"])]),_:1}),e(s,{prop:"ruleId",label:"规则ID",width:"140"}),e(s,{prop:"description",label:"告警描述","min-width":"350"}),e(s,{prop:"sourceIp",label:"源IP",width:"160"}),e(s,{prop:"targetIp",label:"目标IP",width:"160"}),e(s,{prop:"protocol",label:"协议",width:"120"}),e(s,{prop:"timestamp",label:"时间戳",width:"160",sortable:""})]),_:1},8,["data"])]}),_:1})])}}}),Q=W(K,[["__scopeId","data-v-412dc642"]]);export{Q as default};
