# æµé‡æ£€æµ‹ç³»ç»Ÿ (Traffic Analysis System)

ä¸€ä¸ªåŸºäº Vue3 + TypeScript + Element Plus + Vite + Pinia çš„æµé‡åŒ…æ£€æµ‹ç³»ç»Ÿã€‚ç”¨æˆ·å¯ä»¥ä¸Šä¼ ç½‘ç»œæµé‡åŒ…æ–‡ä»¶ï¼Œç³»ç»Ÿå°†ä½¿ç”¨ Suricata å¼•æ“è¿›è¡Œæ£€æµ‹ï¼Œå¹¶æä¾›å‘Šè­¦æŠ¥å‘Šã€‚

## ğŸš€ é¡¹ç›®æ¦‚è¿°

### æ ¸å¿ƒåŠŸèƒ½
- ğŸ”’ **æ— éœ€æ³¨å†Œ**ï¼šå…ç™»å½•ä½¿ç”¨ï¼Œé™ä½ä½¿ç”¨é—¨æ§›
- ğŸ“ **æ–‡ä»¶ä¸Šä¼ **ï¼šæ”¯æŒ .pcap/.pcapng æ ¼å¼ï¼Œæœ€å¤§ 50MB
- ğŸ” **æ™ºèƒ½åˆ†æ**ï¼šåŸºäº Suricata å¼•æ“çš„æ£€æµ‹
- ğŸ“Š **è¯¦ç»†æŠ¥å‘Š**ï¼šæä¾›æ—¶é—´ã€IPã€è§„åˆ™IDã€ä¸¥é‡çº§åˆ«ç­‰å®Œæ•´å‘Šè­¦ä¿¡æ¯
- ğŸ›ï¸ **æ•°æ®ç®¡ç†**ï¼šæ”¯æŒç­›é€‰ã€æ’åºã€å¯¼å‡ºCSVåŠŸèƒ½
- ğŸŒ **åœ°ç†ä½ç½®**ï¼šé›†æˆIPå½’å±åœ°æŸ¥è¯¢
- ğŸ“ˆ **ç»Ÿè®¡é¢æ¿**ï¼šå®æ—¶æ˜¾ç¤ºå…¨å±€åˆ†æç»Ÿè®¡
- ğŸ« **é‚€è¯·ç ç³»ç»Ÿ**ï¼šVIPç”¨æˆ·é¢åº¦æå‡æœºåˆ¶

### æŠ€æœ¯ç‰¹è‰²
- ğŸ¨ **ç°ä»£UIè®¾è®¡**ï¼šåŸºäº Element Plus çš„ç²¾ç¾ç•Œé¢
- ğŸ“± **å“åº”å¼å¸ƒå±€**ï¼šä¸“ä¸ºPCç«¯ä¼˜åŒ–çš„å¸ƒå±€è®¾è®¡
- ğŸ”„ **çŠ¶æ€ç®¡ç†**ï¼šä½¿ç”¨ Pinia è¿›è¡ŒçŠ¶æ€ç®¡ç†
- ğŸ›¡ï¸ **å®‰å…¨é˜²æŠ¤**ï¼šå‰åç«¯åŒé‡æ–‡ä»¶éªŒè¯
- âš¡ **æ€§èƒ½ä¼˜åŒ–**ï¼šViteæ„å»ºå·¥å…·ï¼Œå¿«é€Ÿå¼€å‘ä½“éªŒ

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯æŠ€æœ¯
```json
{
  "æ ¸å¿ƒæ¡†æ¶": "Vue 3.5.13 (Composition API)",
  "å¼€å‘è¯­è¨€": "TypeScript 5.8.2",
  "æ„å»ºå·¥å…·": "Vite 6.3.5",
  "UIç»„ä»¶åº“": "Element Plus 2.9.11",
  "çŠ¶æ€ç®¡ç†": "Pinia 3.0.1",
  "è·¯ç”±ç®¡ç†": "Vue Router 4.5.1",
  "å›¾æ ‡åº“": "@element-plus/icons-vue 2.1.0"
}
```

### å¼€å‘å·¥å…·
```json
{
  "è‡ªåŠ¨å¯¼å…¥": "unplugin-auto-import 19.3.0",
  "ç»„ä»¶å¯¼å…¥": "unplugin-vue-components 28.5.0",
  "ç±»å‹æ£€æŸ¥": "vue-tsc 2.2.8",
  "æ’ä»¶æ”¯æŒ": "@vitejs/plugin-vue 5.2.3"
}
```

### åç«¯æŠ€æœ¯ (è§„åˆ’)
- **Webæ¡†æ¶**: Flask
- **æ•°æ®åº“**: MySQL/Redis
- **åˆ†æå¼•æ“**: Suricata
- **éƒ¨ç½²ç¯å¢ƒ**: Ubuntu 22.04.3

## ğŸ“‹ åŠŸèƒ½è¯¦ç»†è¯´æ˜

### 1. ç”¨æˆ·é¢åº¦ç®¡ç†
- **åŸºç¡€ç”¨æˆ·**: æ¯æ—¥10ä¸ªæµé‡åŒ…é¢åº¦
- **VIPç”¨æˆ·**: é€šè¿‡é‚€è¯·ç æ¿€æ´»ï¼Œæ”¯æŒå¤šçº§é¢åº¦æå‡
- **é¢åº¦é‡ç½®**: æ¯æ—¥0ç‚¹ï¼ˆUTC+8ï¼‰è‡ªåŠ¨é‡ç½®
- **å®‰å…¨æœºåˆ¶**: é‚€è¯·ç é”™è¯¯5æ¬¡åå½“æ—¥IPç¦æ­¢è®¿é—®

#### é‚€è¯·ç ç³»ç»Ÿè®¾è®¡
é‚€è¯·ç å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œæ”¯æŒå¤šç§ä¸åŒçº§åˆ«çš„ä¼šå‘˜æƒé™ï¼š

| é‚€è¯·ç ç±»å‹ | ç¤ºä¾‹ä»£ç  | æ¯æ—¥é¢åº¦ | è¯´æ˜ |
|------------|----------|----------|------|
| ä½“éªŒä¼šå‘˜ | DEMO20 | 20ä¸ª | åŸºç¡€ä½“éªŒç‰ˆæœ¬ |
| å­¦ç”Ÿä¼˜æƒ  | STUDENT30 | 30ä¸ª | æ•™è‚²ç”¨æˆ·ä¸“äº« |
| VIPä¼šå‘˜ | VIP50 | 50ä¸ª | æ ‡å‡†VIPæœåŠ¡ |
| VIPé«˜çº§ä¼šå‘˜ | VIP100 | 100ä¸ª | é«˜çº§VIPæœåŠ¡ |
| VIPè‡³å°Šä¼šå‘˜ | VIP200 | 200ä¸ª | é¡¶çº§VIPæœåŠ¡ |

**é‚€è¯·ç æ•°æ®ç»“æ„**:
```typescript
interface InviteCode {
  code: string        // é‚€è¯·ç 
  quota: number       // æå‡çš„æ¯æ—¥é¢åº¦
  description: string // ä¼šå‘˜ç±»å‹æè¿°
  isActive: boolean   // æ˜¯å¦æ¿€æ´»çŠ¶æ€
}
```

### 2. æ–‡ä»¶ä¸Šä¼ éªŒè¯
#### å‰ç«¯éªŒè¯
- æ–‡ä»¶æ ¼å¼ï¼šä»…æ”¯æŒ `.pcap` å’Œ `.pcapng`
- æ–‡ä»¶å¤§å°ï¼šæœ€å¤§ 50MB
- åè®®ç¡®è®¤ï¼šå¿…é¡»åŒæ„ã€ŠæœåŠ¡æ¡æ¬¾ã€‹å’Œã€Šéšç§æ”¿ç­–ã€‹

#### åç«¯éªŒè¯ï¼ˆè§„åˆ’ï¼‰
- æ–‡ä»¶å¤´éªŒè¯ï¼šæ£€æŸ¥æ–‡ä»¶çœŸå®æ ¼å¼
- å†…å®¹éªŒè¯ï¼šç¡®è®¤ä¸ºæœ‰æ•ˆçš„ç½‘ç»œæµé‡åŒ…

### 3. æ•°æ®ç»Ÿè®¡å±•ç¤º
#### å…¨å±€ç»Ÿè®¡
- ä»Šæ—¥å·²åˆ†ææµé‡åŒ…æ•°é‡
- ä»Šæ—¥å·²åˆ†ææµé‡æ€»å¤§å°ï¼ˆGBï¼‰
- ç´¯è®¡å·²åˆ†ææµé‡åŒ…æ•°é‡
- ç´¯è®¡å·²åˆ†ææµé‡æ€»å¤§å°ï¼ˆTBï¼‰

#### ç”¨æˆ·ä¿¡æ¯
- IPåœ°å€è‡ªåŠ¨è¯†åˆ«
- åœ°ç†ä½ç½®æ˜¾ç¤ºï¼ˆåŸºäºç°æœ‰APIï¼‰
- å®æ—¶å‰©ä½™é¢åº¦æ˜¾ç¤º
- VIPçŠ¶æ€æ ‡è¯†

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ components/          # ç»„ä»¶ç›®å½•
â”‚   â””â”€â”€ Layout.vue      # ä¸»å¸ƒå±€ç»„ä»¶ï¼ˆå¯¼èˆªæ ã€ä¸Šä¼ å¯¹è¯æ¡†ï¼‰
â”œâ”€â”€ views/              # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ Home.vue        # é¦–é¡µï¼ˆç»Ÿè®¡ã€ç”¨æˆ·ä¿¡æ¯ã€ä¸Šä¼ è®°å½•ï¼‰
â”‚   â”œâ”€â”€ GlobalList.vue  # å…¨éƒ¨æµé‡åŒ…åˆ—è¡¨é¡µ
â”‚   â””â”€â”€ AlertDetail.vue # å‘Šè­¦è¯¦æƒ…é¡µ
â”œâ”€â”€ stores/             # çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ traffic.ts      # æµé‡åŒ…ç›¸å…³çŠ¶æ€
â”‚   â””â”€â”€ user.ts         # ç”¨æˆ·ç›¸å…³çŠ¶æ€
â”œâ”€â”€ types/              # TypeScriptç±»å‹å®šä¹‰
â”‚   â””â”€â”€ index.ts        # å…¨å±€ç±»å‹å®šä¹‰
â”œâ”€â”€ router/             # è·¯ç”±é…ç½®
â”‚   â””â”€â”€ index.ts        # è·¯ç”±å®šä¹‰
â”œâ”€â”€ App.vue             # æ ¹ç»„ä»¶
â”œâ”€â”€ main.ts             # åº”ç”¨å…¥å£
â””â”€â”€ style.css           # å…¨å±€æ ·å¼
```

## ğŸ–¥ï¸ é¡µé¢ç»“æ„è¯¦è§£

### å¯¼èˆªæ ç»„ä»¶ (Layout.vue)
- **logoåŒºåŸŸ**: ç³»ç»Ÿå›¾æ ‡ + æ ‡é¢˜
- **å¯¼èˆªèœå•**: é¦–é¡µã€å…¨éƒ¨æµé‡åŒ…
- **ä¸Šä¼ æŒ‰é’®**: è§¦å‘ä¸Šä¼ å¯¹è¯æ¡†

### é¦–é¡µ (Home.vue)
#### ç»Ÿè®¡å¡ç‰‡åŒºåŸŸ
```typescript
// å››ä¸ªç»Ÿè®¡å¡ç‰‡ï¼Œå±•ç¤ºå…¨å±€æ•°æ®
interface Statistics {
  todayAnalyzed: number      // ä»Šæ—¥å·²åˆ†æ
  todayTrafficVolume: string // ä»Šæ—¥å·²åˆ†ææµé‡
  totalAnalyzed: number      // ç´¯è®¡å·²åˆ†æ
  totalTrafficVolume: string // ç´¯è®¡å·²åˆ†ææµé‡
}
```

#### ç”¨æˆ·ä¿¡æ¯å¡ç‰‡
```typescript
interface UserInfo {
  ip: string           // IPåœ°å€
  location: string     // å½’å±åœ°
  dailyQuota: number   // æ¯æ—¥æ€»é¢åº¦
  remainingQuota: number // ä»Šæ—¥å‰©ä½™é¢åº¦
  isVipUser: boolean   // æ˜¯å¦VIPç”¨æˆ·
}
```

#### ä¸Šä¼ è®°å½•è¡¨æ ¼
- æ–‡ä»¶åã€æ–‡ä»¶å¤§å°ã€ä¸Šä¼ æ—¶é—´
- åˆ†æè€—æ—¶ã€å‘Šè­¦æ•°é‡ã€å‘Šè­¦ç§ç±»
- çŠ¶æ€æ ‡è¯†ã€æ“ä½œæŒ‰é’®

### å…¨éƒ¨æµé‡åŒ…åˆ—è¡¨ (GlobalList.vue)
#### æœç´¢è¿‡æ»¤åŠŸèƒ½
- æ–‡ä»¶åæ¨¡ç³Šæœç´¢
- å‘Šè­¦æ•°é‡ç­›é€‰ï¼ˆå…¨éƒ¨/æœ‰å‘Šè­¦/æ— å‘Šè­¦ï¼‰
- çŠ¶æ€ç­›é€‰ï¼ˆå…¨éƒ¨/å·²å®Œæˆ/åˆ†æä¸­/åˆ†æå¤±è´¥ï¼‰

#### æ•°æ®è¡¨æ ¼
```typescript
interface TrafficPacket {
  id: number
  filename: string      // æ–‡ä»¶å
  uploadTime: string    // ä¸Šä¼ æ—¶é—´
  fileSize: string      // æ–‡ä»¶å¤§å°
  alertCount: number    // å‘Šè­¦æ•°é‡
  status: 'analyzing' | 'completed' | 'failed' // çŠ¶æ€
  analysisTime?: string // åˆ†æè€—æ—¶
  userIp?: string      // ç”¨æˆ·IP
  userLocation?: string // ç”¨æˆ·åœ°åŒº
  alertTypes?: number  // å‘Šè­¦ç§ç±»
}
```

### å‘Šè­¦è¯¦æƒ…é¡µ (AlertDetail.vue)
#### é¡µé¢å¤´éƒ¨
- è¿”å›æŒ‰é’®
- æ–‡ä»¶åæ˜¾ç¤º
- ä¸‹è½½æ–‡ä»¶æŒ‰é’®
- å¯¼å‡ºå‘Šè­¦åˆ—è¡¨æŒ‰é’®

#### å‘Šè­¦åˆ—è¡¨è¡¨æ ¼
```typescript
interface Alert {
  id: number
  severity: 'high' | 'medium' | 'low' // ä¸¥é‡ç­‰çº§
  ruleId: string         // è§„åˆ™ID
  description: string    // å‘Šè­¦æè¿°
  sourceIp: string      // æºIP
  targetIp: string      // ç›®æ ‡IP
  protocol: string      // åè®®
  timestamp: string     // æ—¶é—´æˆ³
}
```

## ğŸ“¦ çŠ¶æ€ç®¡ç† (Pinia Stores)

### æµé‡åŒ…çŠ¶æ€ (traffic.ts)
```typescript
// ä¸»è¦åŠŸèƒ½
- uploadFile()          // æ–‡ä»¶ä¸Šä¼ å¤„ç†
- getAnalysisResult()   // è·å–æ£€æµ‹ç»“æœ
- searchTrafficPackets() // æœç´¢ç­›é€‰æµé‡åŒ…
- statistics           // å…¨å±€ç»Ÿè®¡æ•°æ®
- userTrafficPackets   // ç”¨æˆ·ä¸Šä¼ è®°å½•
- allTrafficPackets    // å…¨éƒ¨æµé‡åŒ…åˆ—è¡¨
```

### ç”¨æˆ·çŠ¶æ€ (user.ts)
```typescript
// ä¸»è¦åŠŸèƒ½
- applyInviteCode()           // åº”ç”¨é‚€è¯·ç 
- consumeQuota()              // æ¶ˆè´¹é¢åº¦
- getAvailableInviteCodes()   // è·å–å¯ç”¨é‚€è¯·ç åˆ—è¡¨
- userInfo                    // ç”¨æˆ·ä¿¡æ¯
- inviteCodeAttempts          // é‚€è¯·ç å°è¯•æ¬¡æ•°
- isBlocked                   // æ˜¯å¦è¢«ç¦æ­¢è®¿é—®

// é‚€è¯·ç æ•°æ®
- inviteCodes[]               // æ¨¡æ‹Ÿé‚€è¯·ç æ•°æ®åº“
```

## ğŸ¨ UIè®¾è®¡è§„èŒƒ

### é¢œè‰²ä¸»é¢˜
```css
:root {
  --el-color-primary: #2563eb;      /* ä¸»è‰²è°ƒ */
  --el-color-success: #059669;      /* æˆåŠŸè‰² */
  --el-color-warning: #d97706;      /* è­¦å‘Šè‰² */
  --el-color-danger: #dc2626;       /* å±é™©è‰² */
  --el-color-info: #64748b;         /* ä¿¡æ¯è‰² */
}
```

### ç»„ä»¶æ ·å¼
- **å¡ç‰‡**: 12px åœ†è§’ï¼ŒæŸ”å’Œé˜´å½±
- **æŒ‰é’®**: 8px åœ†è§’ï¼Œ500å­—é‡
- **è¡¨æ ¼**: æ¡çº¹æ ·å¼ï¼Œæ‚¬åœæ•ˆæœ
- **è¾“å…¥æ¡†**: 8px åœ†è§’ï¼Œèšç„¦é«˜äº®

## ğŸš€ å¼€å‘æŒ‡å—

### ç¯å¢ƒè¦æ±‚
- Node.js >= 16.0.0
- npm >= 8.0.0

### å®‰è£…ä¾èµ–
```bash
npm install
```

### å¼€å‘å¯åŠ¨
```bash
npm run dev
```

### é¡¹ç›®æ„å»º
```bash
npm run build
```

### é¢„è§ˆæ„å»º
```bash
npm run preview
```

### ä»£ç è§„èŒƒ
- ä½¿ç”¨ TypeScript ä¸¥æ ¼æ¨¡å¼
- éµå¾ª Vue 3 Composition API è§„èŒƒ
- ç»„ä»¶å‘½åé‡‡ç”¨ PascalCase
- æ–¹æ³•å‘½åé‡‡ç”¨ camelCase



## ğŸ“ APIæ¥å£è®¾è®¡ (è§„åˆ’)

### æ–‡ä»¶ä¸Šä¼ 
```typescript
POST /api/upload
Content-Type: multipart/form-data

Request:
- file: File (pcap/pcapng)
- agreed: boolean

Response:
{
  success: boolean
  message: string
  data?: {
    id: number
    filename: string
    status: string
  }
}
```

### è·å–åˆ†æç»“æœ
```typescript
GET /api/analysis/:id

Response:
{
  success: boolean
  data: AnalysisResult
}
```

### è·å–æµé‡åŒ…åˆ—è¡¨
```typescript
GET /api/traffic-packets
Query: filename?, alertFilter?, statusFilter?, page?, pageSize?

Response:
{
  success: boolean
  data: {
    list: TrafficPacket[]
    total: number
  }
}
```

### ç»Ÿè®¡ä¿¡æ¯
```typescript
GET /api/statistics

Response:
{
  success: boolean
  data: Statistics
}
```

### ç”¨æˆ·ä¿¡æ¯
```typescript
GET /api/user/info

Response:
{
  success: boolean
  data: UserInfo
}
```

### é‚€è¯·ç éªŒè¯
```typescript
POST /api/user/invite-code
Body: { code: string }

Response:
{
  success: boolean
  message: string
  quota?: number        // æå‡åçš„æ€»é¢åº¦
  description?: string  // ä¼šå‘˜ç±»å‹æè¿°
}
```





## ğŸ”’ å®‰å…¨æœºåˆ¶

### æ–‡ä»¶å®‰å…¨
1. **å‰ç«¯éªŒè¯**: æ–‡ä»¶ç±»å‹ã€å¤§å°æ£€æŸ¥
2. **åç«¯éªŒè¯**: æ–‡ä»¶å¤´ã€å†…å®¹éªŒè¯

### è®¿é—®æ§åˆ¶
1. **IPé™åˆ¶**: åŸºäºIPçš„ä¸Šä¼ é¢åº¦æ§åˆ¶
2. **é¢‘ç‡é™åˆ¶**: é˜²æ­¢æ¶æ„ä¸Šä¼ 
3. **é‚€è¯·ç é˜²æŠ¤**: é˜²æš´åŠ›ç ´è§£æœºåˆ¶
4. **æ–‡ä»¶æ¸…ç†**: å®šæœŸæ¸…ç†è¿‡æœŸæ–‡ä»¶

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### å‰ç«¯ä¼˜åŒ–
- ç»„ä»¶æ‡’åŠ è½½
- è·¯ç”±çº§åˆ«ä»£ç åˆ†å‰²
- Element Plus æŒ‰éœ€å¼•å…¥

### æ•°æ®å¤„ç†
- è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¤§æ•°æ®é‡ï¼‰
- åˆ†é¡µåŠ è½½
- æœç´¢é˜²æŠ–
- ç¼“å­˜æœºåˆ¶

## ğŸ”§ éƒ¨ç½²é…ç½®

### ç”Ÿäº§ç¯å¢ƒ
- **æœåŠ¡å™¨**:  Ubuntu 22.04.3
- **WebæœåŠ¡**: Nginx
- **è¿›ç¨‹ç®¡ç†**: PM2
- **SSLè¯ä¹¦**: Let's Encrypt

### ç¯å¢ƒå˜é‡
```bash
# å¼€å‘ç¯å¢ƒ
VITE_APP_ENV=development
VITE_API_BASE_URL=http://localhost:5000

# ç”Ÿäº§ç¯å¢ƒ
VITE_APP_ENV=production
VITE_API_BASE_URL=https://api.example.com
```

## ğŸ“ˆ åŠŸèƒ½æ‰©å±•è®¡åˆ’

### çŸ­æœŸç›®æ ‡
- [ ] åç«¯APIå¼€å‘
- [ ] Suricataå¼•æ“é›†æˆ
- [ ] é‚€è¯·ç æ•°æ®åº“è¡¨è®¾è®¡
- [ ] æ–‡ä»¶å­˜å‚¨ä¼˜åŒ–



## ğŸ› é—®é¢˜åé¦ˆ

å¦‚æœæ‚¨åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼åé¦ˆï¼š
1. æäº¤ GitHub Issues
2. è”ç³»ç³»ç»Ÿç®¡ç†å‘˜
3. æŸ¥çœ‹åœ¨çº¿æ–‡æ¡£

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

---

**æ³¨æ„**: æœ¬ç³»ç»Ÿä¸“ä¸ºPCç«¯è®¾è®¡ï¼Œæš‚ä¸æ”¯æŒç§»åŠ¨ç«¯è®¿é—®ã€‚è¯·ä½¿ç”¨æ¡Œé¢æµè§ˆå™¨è·å¾—æœ€ä½³ä½“éªŒã€‚

